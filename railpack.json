{
  "version": "1",
  "packages": {
    "python": "3.12.11",
    "node": "22.11.0",
    "yarn": "4.9.2"
  },
  "install": [
    {
      "command": "python -m venv /app/.venv",
      "cache": "/app/.venv"
    },
    {
      "command": "source /app/.venv/bin/activate && pip install -r requirements.txt",
      "dependsOn": ["requirements.txt", "backend/pyproject.toml"]
    },
    {
      "command": "corepack enable && corepack prepare yarn@4.9.2 --activate",
      "description": "Enable Yarn 4"
    },
    {
      "command": "yarn install",
      "dependsOn": ["package.json", "yarn.lock"],
      "cache": "node_modules"
    },
    {
      "command": "yarn workspace z2-frontend build",
      "dependsOn": ["frontend/"],
      "output": "frontend/dist"
    }
  ],
  "deploy": {
    "command": "/app/.venv/bin/python /app/run_server.py",
    "healthcheck": {
      "path": "/health",
      "interval": "30s",
      "timeout": "5s"
    }
  },
  "environment": {
    "NODE_ENV": "production",
    "PYTHON_ENV": "production",
    "PORT": "$PORT",
    "APP_NAME": "Z2 AI Workforce Platform",
    "APP_VERSION": "0.1.0",
    "DEBUG": "false",
    "LOG_LEVEL": "INFO",
    "API_V1_PREFIX": "/api/v1",
    "JWT_SECRET_KEY": "${{JWT_SECRET_KEY}}",
    "JWT_ACCESS_TOKEN_EXPIRE_MINUTES": "30",
    "JWT_REFRESH_TOKEN_EXPIRE_DAYS": "7",
    "DATABASE_URL": "${{DATABASE_URL}}",
    "STORAGE_PATH": "/opt/app/storage"
  }
}